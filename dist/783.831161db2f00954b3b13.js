(self.webpackChunktiny_host_common=self.webpackChunktiny_host_common||[]).push([[783],{783:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"tiny-login"}},[t("h1",[e._v("login")]),e._v(" "),t("div",{staticClass:"form"},[t("div",{staticClass:"field"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],ref:"username",attrs:{placeholder:"username"},domProps:{value:e.username},on:{input:function(s){s.target.composing||(e.username=s.target.value)}}})]),e._v(" "),t("div",{staticClass:"field"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{placeholder:"password",type:"password",pattern:e.registering?"\\w{4,}":null},domProps:{value:e.password},on:{keyup:function(s){if(!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter"))return null;!e.registering&&e.login()},input:function(s){s.target.composing||(e.password=s.target.value)}}}),e._v(" "),e.registering?t("span",{staticClass:"error"},[e._v(e._s((e.username||e.password)&&e.password.length<4?"At least 4 characters.":""))]):e._e()]),e._v(" "),e.registering?t("div",{staticClass:"field"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmpass,expression:"confirmpass"}],attrs:{placeholder:"confirm password",type:"password",pattern:e.password},domProps:{value:e.confirmpass},on:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.register()},input:function(s){s.target.composing||(e.confirmpass=s.target.value)}}}),e._v(" "),t("span",{staticClass:"error"},[e._v(e._s(e.password&&e.password!==e.confirmpass?"this != password":""))])]):e._e()]),e._v(" "),t("div",{attrs:{id:"buttons"}},[e.registering?[t("button",{on:{click:function(s){e.registering=!1}}},[e._v("cancel")]),e._v(" "),t("button",{staticClass:"primary",attrs:{disabled:!e.valid||e.working},on:{click:function(s){return e.register()}}},[e._v("register")])]:[e.canRegister?t("a",{on:{click:function(s){e.registering=!0}}},[e._v("register")]):e._e(),e._v(" "),t("div",{staticStyle:{"flex-grow":"1"}}),e._v(" "),t("button",{staticClass:"primary",attrs:{disabled:!e.valid||e.working},on:{click:e.login}},[e._v("login")])]],2)])};r._withStripped=!0;var i=t(670),a=t(79),n=t(271),o=t(517);const u=i.Z.extend({name:"tiny-login",data:()=>({registering:!1,canRegister:!0,working:!1,username:"",password:"",confirmpass:""}),watch:{registering(e,s){!e!=!s&&(this.username="",this.password="",this.confirmpass="")}},computed:{valid(){return this.username&&this.password&&/\w{4,}/.test(this.password)&&(!this.registering||this.confirmpass===this.password)}},mounted(){var e;this.$route.query.username&&(this.username=""+this.$route.query.username),null===(e=this.$refs.username)||void 0===e||e.focus()},methods:{async register(){if(this.working||!this.valid)return;this.working=!0;await a.Z.auth.register(this.username,this.password).then((()=>!0),(()=>!1))&&(await(0,o.h7)({title:"Registered",message:'Registered as "'+this.username+'"!',type:"success",alert:!0}),this.registering=!1),this.working=!1},async login(){var e;if(this.working||!this.username||!this.password)return;this.working=!0;let s=await a.Z.auth.login(this.username,this.password).then((()=>!0),(e=>!1));s||null===(e=this.$refs.username)||void 0===e||e.focus(),s&&(s=await a.Z.getSelf().then((()=>!0),(()=>!1))),s?!this.$route.query.goto||this.$route.query.goto instanceof Array?this.$router.push("/"):this.$router.push(this.$route.query.goto):n.Z.clear(),this.working=!1}}});var l=(0,t(900).Z)(u,r,[],!1,null,null,null);l.options.__file="src/web/pages/login.vue";const d=l.exports}}]);