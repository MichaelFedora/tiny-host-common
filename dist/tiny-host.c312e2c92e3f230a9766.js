(()=>{"use strict";var e,t,n,s,a={522:(e,t,n)=>{var s=n(670),a=n(517),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("h3",[e._v("tiny "+e._s(e.type?e.type+"s ":"")+"host"),e.loggedIn?[e._v(" - "+e._s(e.username))]:e._e()],2),e._v(" "),n("router-view")],1)};o._withStripped=!0;var r=n(271);const i=s.Z.extend({name:"app",data(){var e;return{loggedIn:Boolean(r.Z.session),type:r.Z.type||"",username:(null===(e=r.Z.user)||void 0===e?void 0:e.username)||"",page:this.$route.name||""}},watch:{$route(e,t){var n,s;e.path!==t.path&&(/^\/login/.test(e.path)?(this.loggedIn&&(this.loggedIn=Boolean(r.Z.session)),this.username&&(this.username=null===(s=r.Z.user)||void 0===s?void 0:s.username)):(this.loggedIn||(this.loggedIn=Boolean(r.Z.session)),this.username||(this.username=null===(n=r.Z.user)||void 0===n?void 0:n.username)),this.page=e.name)}}});var l=n(900),d=(0,l.Z)(i,o,[],!1,null,null,null);d.options.__file="src/web/app.vue";const c=d.exports;var u=function(){var e=this.$createElement;return(this._self._c||e)("div",{attrs:{id:"tiny-loading"}})};u._withStripped=!0;const p={name:"tiny-loading"};var h=(0,l.Z)(p,u,[],!1,null,null,null);h.options.__file="src/web/components/loading.vue";const m=h.exports;var v=n(691),f=n(79);s.Z.use(a.m5),console.log("Environment: ","production");const g=new s.Z({router:v.Z,el:"#app",components:{AppComponent:c},data:{loaded:!1},render(e){return this.loaded?e(c,{key:"app"}):(0,a.gI)(e,m)}});(async()=>{await f.Z.getType(),r.Z.session&&await f.Z.getSelf().catch((()=>{}))})().then((()=>{console.log("Initialized Main!"),g.loaded=!0}),(e=>{console.error("Error initializing main: ",e.stack||e.message||e),(0,a.h7)({title:"Error",message:"Error initializing main: "+String(e.message||e),type:"danger",alert:!0})}))},691:(e,t,n)=>{n.d(t,{Z:()=>u});var s=n(670),a=n(990),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"tiny-not-found"}},[n("h1",[e._v("404 Not Found")]),e._v(" "),n("p",[e._v("Couldn't find the page you were looking for. Try going "),n("router-link",{attrs:{to:"/"}},[e._v("Home")]),e._v("?")],1)])};o._withStripped=!0;const r={name:"tiny-not-found"};var i=(0,n(900).Z)(r,o,[],!1,null,null,null);i.options.__file="src/web/pages/not-found.vue";const l=i.exports;var d=n(271);s.Z.use(a.Z);const c=new a.Z({mode:"history",routes:[{path:"/",component:()=>n.e(148).then(n.bind(n,148)),name:"home"},{path:"/sessions",component:()=>Promise.all([n.e(700),n.e(868)]).then(n.bind(n,515)),name:"sessions"},{path:"/login",component:()=>n.e(783).then(n.bind(n,783)),name:"login"},{path:"/handshake",component:()=>n.e(315).then(n.bind(n,315)),name:"handshake"},{path:"**",component:l,name:"not-found"}]});c.beforeEach(((e,t,n)=>{const s="tiny "+(d.Z.type?d.Z.type+"s ":"")+"host";if(e.path!==t.path)if(e.name)document.title=s+" - "+e.name;else if(e.path.length>1){const t=[];let n="";e.path.slice(1).split("/").forEach((e=>{e?n?t.push(n+e):t.push(e):n+="/"})),document.title=s+" - "+t.join(" - ")}else document.title=s;d.Z.session||/^\/login/.test(e.path)||n(`/login?goto=${e.fullPath}`),n()}));const u=c},271:(e,t,n)=>{n.d(t,{Z:()=>s});const s=new class{constructor(){this.user=null,this.type=void 0}get session(){return localStorage.getItem("sid")}set session(e){localStorage.setItem("sid",e)}clear(){localStorage.clear(),this.user=null}}},79:(e,t,n)=>{n.d(t,{Z:()=>c});var s=n(222),a=n.n(s),o=n(517),r=n(271),i=n(691);const l=location.origin;function d(e){var t,n,s;e&&(403===(null===(t=e.response)||void 0===t?void 0:t.status)&&"No session found!"===(null===(s=null===(n=e.response)||void 0===n?void 0:n.data)||void 0===s?void 0:s.message)&&r.Z.clear(),r.Z.session||/^\/login/.test(i.Z.currentRoute.path)||i.Z.push(`/login?goto=${i.Z.currentRoute.fullPath}`),(0,o.S3)(e))}const c=new class{constructor(){this._auth=Object.freeze({async login(e,t){await a().post(`${l}/auth/login`,{username:e,password:t}).then((e=>r.Z.session=String(e.data)),(e=>{throw d(e),e}))},register:async(e,t)=>a().post(`${l}/auth/register`,{username:e,password:t}).then((()=>null),(e=>{throw d(e),e})),async refresh(){await a().get(`${l}/auth/refresh?sid=${r.Z.session}`).then((e=>r.Z.session=String(e.data)),d)},getSessions:async()=>a().get(`${l}/auth/sessions?sid=${r.Z.session}`).then((e=>e.data)).catch((e=>{throw d(e),e})),async delSession(e){await a().delete(`${l}/auth/sessions/${e}?sid=${r.Z.session}`).catch(d)},async clearSessions(){await a().delete(`${l}/auth/sessions?sid=${r.Z.session}`).catch(d)},async logout(){await a().post(`${l}/auth/logout?sid=${r.Z.session}`).catch(d),r.Z.clear()},async changePass(e,t){await a().post(`${l}/auth/change-pass?sid=${r.Z.session}`,{password:e,newpass:t}).catch((e=>{throw d(e),e}))},getHandshakeInfo:async e=>a().get(`${l}/auth/handshake/${e}?sid=${r.Z.session}`).then((e=>e.data),d),approveHandshake(e){location.href=`${l}/auth/handshake/${e}/approve?sid=${r.Z.session}`},cancelHandshake(e){location.href=`${l}/auth/handshake/${e}/cancel?sid=${r.Z.session}`},getMasterKeys:async()=>a().get(`${l}/auth/master-key?sid=${r.Z.session}`).then((e=>e.data),(e=>{throw d(e),e})),addMasterKey:async e=>a().post(`${l}/auth/master-key?name=${e}&sid=${r.Z.session}`).then((e=>e.data),(e=>{throw d(e),e})),async updateMasterKey(e,t){await a().put(`${l}/auth/master-key/${e}?sid=${r.Z.session}`,{name:t})},async delMasterKey(e){await a().delete(`${l}/auth/master-key/${e}?sid=${r.Z.session}`)}})}get url(){return l}get auth(){return this._auth}async getType(){const e=await a().get(`${l}/type`).then((e=>e.data)).catch((e=>{}));return r.Z.type=e,e}async getSelf(){const e=await a().get(`${l}/self?sid=${r.Z.session}`).then((e=>e.data)).catch((e=>{throw d(e),e}));return r.Z.user=e,e}async deleteSelf(e){await a().delete(`${l}/self?sid=${r.Z.session}&pass=${e}`).catch((e=>{throw d(e),e})),r.Z.clear()}}},517:(e,t,n)=>{n.d(t,{m5:()=>h,S3:()=>p,gI:()=>i,MO:()=>u,h7:()=>c});var s=function(){var e,t,n,s,a=this,o=a.$createElement,r=a._self._c||o;return r("transition",{attrs:{name:"fade"}},[a.active?r("div",{staticClass:"modal is-active",class:a.classes,attrs:{role:"dialog","aria-modal":"modal"}},[r("div",{staticClass:"modal-background",on:{click:function(e){return a.cancel()}}}),a._v(" "),r("div",{staticClass:"modal-card"},[r("header",{directives:[{name:"show",rawName:"v-show",value:a.title,expression:"title"}]},[r("span",[a._v(a._s(a.title))])]),a._v(" "),r("section",[r("p",[a._v(a._s(a.message))]),a._v(" "),a.input?r("div",{staticClass:"field"},["checkbox"===a.input.type?r("input",{directives:[{name:"model",rawName:"v-model",value:a.text,expression:"text"}],ref:"input",class:(e={},e[a.type]=!0,e),attrs:{placeholder:a.input.placeholder,required:a.input.required,readonly:a.input.readonly,type:"checkbox"},domProps:{checked:Array.isArray(a.text)?a._i(a.text,null)>-1:a.text},on:{change:function(e){var t=a.text,n=e.target,s=!!n.checked;if(Array.isArray(t)){var o=a._i(t,null);n.checked?o<0&&(a.text=t.concat([null])):o>-1&&(a.text=t.slice(0,o).concat(t.slice(o+1)))}else a.text=s}}}):"radio"===a.input.type?r("input",{directives:[{name:"model",rawName:"v-model",value:a.text,expression:"text"}],ref:"input",class:(t={},t[a.type]=!0,t),attrs:{placeholder:a.input.placeholder,required:a.input.required,readonly:a.input.readonly,type:"radio"},domProps:{checked:a._q(a.text,null)},on:{change:function(e){a.text=null}}}):r("input",{directives:[{name:"model",rawName:"v-model",value:a.text,expression:"text"}],ref:"input",class:(n={},n[a.type]=!0,n),attrs:{placeholder:a.input.placeholder,required:a.input.required,readonly:a.input.readonly,type:a.input.type},domProps:{value:a.text},on:{input:function(e){e.target.composing||(a.text=e.target.value)}}}),a._v(" "),r("span",{staticClass:"error"},[a._v(a._s(a.input.required&&""===a.text?"required":""))])]):a._e()]),a._v(" "),r("footer",[a.alert?a._e():r("button",{on:{click:a.cancel}},[a._v("cancel")]),a._v(" "),r("button",{ref:"submit",class:(s={},s[a.type]=!0,s),attrs:{disabled:a.input&&a.input.required&&!a.text},on:{click:a.confirm,keydown:function(e){return!e.type.indexOf("key")&&a._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:a.cancel(e)}}},[a._v(a._s(a.alert?"ok":"confirm"))])])])]):a._e()])};s._withStripped=!0;const a={name:"tiny-modal",props:{title:String,message:String,type:{type:String,default:"primary"},alert:Boolean,prompt:{type:Object,default:()=>null}},data:()=>({active:!1,text:void 0}),computed:{classes(){return{[this.type]:!0}},input(){return this.prompt?Object.assign({type:"text",placeholder:"",required:!1,readonly:Boolean(this.alert)},this.prompt):null}},mounted(){var e;this.active=!0,this.$nextTick((()=>{var e,t;return this.input?null===(e=this.$refs.input)||void 0===e?void 0:e.focus():null===(t=this.$refs.submit)||void 0===t?void 0:t.focus()})),window.addEventListener("keyup",this.onKey),(null===(e=this.prompt)||void 0===e?void 0:e.value)&&(this.text=this.prompt.value)},destroyed(){window.removeEventListener("keyup",this.onKey)},methods:{confirm(){this.active&&(this.$emit("confirm",!this.input||this.text),this.close())},cancel(){this.active&&(this.$emit("cancel"),this.close())},close(){this.active&&(this.active=!1,setTimeout((()=>{var e;this.$destroy(),void 0!==(e=this.$el).remove?e.remove():void 0!==e.parentNode&&null!==e.parentNode&&e.parentNode.removeChild(e)}),150))},onKey(e){this.active&&("Enter"===e.key?this.confirm():"Escape"===e.key&&this.cancel())}}};var o=(0,n(900).Z)(a,s,[],!1,null,null,null);o.options.__file="src/web/components/modal.vue";const r=o.exports;function i(e,t){return e("div",{staticStyle:{display:"flex",flexFlow:"column",flexWrap:"nowrap",alignItems:"center",justifyContent:"center",position:"fixed",top:"0",left:"0",height:"100%",width:"100%",backgroundColor:"transparent"}},[e(t)])}let l;let d;async function c(e){const t=("undefined"!=typeof window&&window.Vue?window.Vue:d||l).extend(r),n=document.createElement("div");document.body.append(n);const s=new t({el:n,propsData:e});return new Promise((e=>{s.$on("confirm",(t=>{e(t)})),s.$on("cancel",(()=>e(void 0)))}))}async function u(e,t){const n=("undefined"!=typeof window&&window.Vue?window.Vue:d||l).extend(e),s=document.createElement("div");document.body.append(s);const a=new n({el:s,propsData:t});return new Promise((e=>{a.$on("confirm",(t=>{e(t)})),a.$on("cancel",(()=>e(void 0)))}))}async function p(e,t){var n,s;return c({title:t?"Error "+t:"Error",message:(null===(s=null===(n=e.response)||void 0===n?void 0:n.data)||void 0===s?void 0:s.message)||e.message||String(e),type:"danger",alert:!0})}const h={install(e){d=e}}}},o={};function r(e){if(o[e])return o[e].exports;var t=o[e]={exports:{}};return a[e](t,t.exports,r),t.exports}r.m=a,r.x=e=>{},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>e+"."+{148:"429edf90ea159012741f",315:"3fc3b557bbb4cd14c2bb",700:"fe160bc5ea3d2665bbad",783:"831161db2f00954b3b13",868:"610a31c6d570b84ca8b1"}[e]+".js",r.miniCssF=e=>e+".css",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="tiny-host-common:",r.l=(n,s,a,o)=>{if(e[n])e[n].push(s);else{var i,l;if(void 0!==a)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+a){i=u;break}}i||(l=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,r.nc&&i.setAttribute("nonce",r.nc),i.setAttribute("data-webpack",t+a),i.src=n),e[n]=[s];var p=(t,s)=>{i.onerror=i.onload=null,clearTimeout(h);var a=e[n];if(delete e[n],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach((e=>e(s))),t)return t(s)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),l&&document.head.appendChild(i)}},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="",n=e=>new Promise(((t,n)=>{var s=r.miniCssF(e),a=r.p+s;if(((e,t)=>{for(var n=document.getElementsByTagName("link"),s=0;s<n.length;s++){var a=(r=n[s]).getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(a===e||a===t))return r}var o=document.getElementsByTagName("style");for(s=0;s<o.length;s++){var r;if((a=(r=o[s]).getAttribute("data-href"))===e||a===t)return r}})(s,a))return t();((e,t,n,s)=>{var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",a.onerror=a.onload=o=>{if(a.onerror=a.onload=null,"load"===o.type)n();else{var r=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=r,l.request=i,a.parentNode.removeChild(a),s(l)}},a.href=t,document.head.appendChild(a)})(e,a,t,n)})),s={945:0},r.f.miniCss=(e,t)=>{s[e]?t.push(s[e]):0!==s[e]&&{148:1,315:1,783:1,868:1}[e]&&t.push(s[e]=n(e).then((()=>{s[e]=0}),(t=>{throw delete s[e],t})))},(()=>{var e={945:0},t=[[522,658]];r.f.j=(t,n)=>{var s=r.o(e,t)?e[t]:void 0;if(0!==s)if(s)n.push(s[2]);else{var a=new Promise(((n,a)=>{s=e[t]=[n,a]}));n.push(s[2]=a);var o=r.p+r.u(t),i=new Error;r.l(o,(n=>{if(r.o(e,t)&&(0!==(s=e[t])&&(e[t]=void 0),s)){var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",i.name="ChunkLoadError",i.type=a,i.request=o,s[1](i)}}),"chunk-"+t,t)}};var n=e=>{},s=(s,a)=>{for(var o,i,[l,d,c,u]=a,p=0,h=[];p<l.length;p++)i=l[p],r.o(e,i)&&e[i]&&h.push(e[i][0]),e[i]=0;for(o in d)r.o(d,o)&&(r.m[o]=d[o]);for(c&&c(r),s&&s(a);h.length;)h.shift()();return u&&t.push.apply(t,u),n()},a=self.webpackChunktiny_host_common=self.webpackChunktiny_host_common||[];function o(){for(var n,s=0;s<t.length;s++){for(var a=t[s],o=!0,i=1;i<a.length;i++){var l=a[i];0!==e[l]&&(o=!1)}o&&(t.splice(s--,1),n=r(r.s=a[0]))}return 0===t.length&&(r.x(),r.x=e=>{}),n}a.forEach(s.bind(null,0)),a.push=s.bind(null,a.push.bind(a));var i=r.x;r.x=()=>(r.x=i||(e=>{}),(n=o)())})();r.x()})();