var M=Object.defineProperty,S=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var g=(n,e,o)=>e in n?M(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,w=(n,e)=>{for(var o in e||(e={}))D.call(e,o)&&g(n,o,e[o]);if(v)for(var o of v(e))V.call(e,o)&&g(n,o,e[o]);return n},m=(n,e)=>S(n,q(e));import{_ as j,a as A,d as E,l as p,r as h,m as N}from"./index.4969d68a.js";import{d as _,r as c,c as T,o as x,n as K,g as f,b as y,w as C,i as a,j as k,I as $,t as P,p as U,u as z,H,J as I,z as b,h as J,l as L,e as R}from"./vendor.beb7d023.js";const F={class:"field"},G={class:"error"},O={class:"field"},Q={class:"error"},W=_({emits:["confirm"],setup(n,{emit:e}){const o=c(null),l=c(void 0),t=c(void 0),d=T(()=>!Boolean(!l.value||!t.value||t.value.length<4));x(()=>{K(()=>{var r;return(r=o.value)==null?void 0:r.focus()})});function u(){!d.value||e("confirm",{password:l.value,newpass:t.value})}return(r,s)=>(f(),y(j,{valid:z(d),title:"Change Password",type:"warning",onConfirm:s[3]||(s[3]=i=>u())},{default:C(()=>[a("div",F,[k(a("input",{class:"warning",type:"password",ref:(i,B)=>{B.passEl=i,o.value=i},required:"",placeholder:"old password","onUpdate:modelValue":s[0]||(s[0]=i=>l.value=i)},null,512),[[$,l.value]]),a("span",G,P(l.value===""?"required":""),1)]),a("div",O,[k(a("input",{class:"warning",type:"password",required:"",placeholder:"new password","onUpdate:modelValue":s[1]||(s[1]=i=>t.value=i),onKeydown:s[2]||(s[2]=U(i=>u(),["enter"]))},null,544),[[$,t.value]]),a("span",Q,P(t.value!=null?t.value===""?"required":t.value.length<4?"at least 4 characters":"":""),1)])]),_:1},8,["valid"]))}});const X=_({components:{ChangePassModal:W},setup(n,e){var r;const o=H({working:!1,username:((r=E.user)==null?void 0:r.username)||"???",showChangePass:!1});async function l(){o.working||(o.working=!0,o.working=!1)}async function t(s){s&&typeof s=="object"&&await p.auth.changePass(s.password,s.newpass).catch(()=>{})}async function d(){await p.auth.logout(),h.push("/login")}async function u(){const s=await N.open({title:"Delete Account",type:"danger",message:"Are you sure you want to delete your account? This cannot be undone.",prompt:{type:"password",placeholder:"password",required:!0}});s&&await p.deleteSelf(s).then(()=>h.push("/login"),()=>{})}return l(),m(w({},I(o)),{refresh:l,changePass:t,logout:d,deleteSelf:u})}}),Y={id:"tiny-home"},Z=a("span",null,"Manage Sessions",-1),ee=a("span",null,"Change Password",-1),se=[ee],ne=a("span",null,"Delete Account",-1),oe=[ne],ae=a("span",null,"Logout",-1),te=[ae];function le(n,e,o,l,t,d){const u=b("ChangePassModal"),r=b("router-link");return f(),J("div",Y,[n.showChangePass?(f(),y(u,{key:0,onDestroy:e[0]||(e[0]=s=>n.showChangePass=!1),onConfirm:n.changePass},null,8,["onConfirm"])):L("",!0),a("div",null,[R(r,{class:"button info",to:"/sessions"},{default:C(()=>[Z]),_:1}),a("button",{class:"warning",onClick:e[1]||(e[1]=s=>n.showChangePass=!0)},se),a("button",{class:"danger",onClick:e[2]||(e[2]=(...s)=>n.deleteSelf&&n.deleteSelf(...s))},oe),a("button",{class:"primary",onClick:e[3]||(e[3]=(...s)=>n.logout&&n.logout(...s))},te)])])}var de=A(X,[["render",le]]);export{de as default};
