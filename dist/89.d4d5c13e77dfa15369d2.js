(self.webpackChunktiny_host_common=self.webpackChunktiny_host_common||[]).push([[89],{89:(s,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>h});var a=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{attrs:{id:"tiny-home"}},[t("div",[t("router-link",{staticClass:"button info",attrs:{to:"/sessions"}},[t("span",[s._v("Manage Sessions")])]),s._v(" "),t("button",{staticClass:"warning",on:{click:s.changePass}},[t("span",[s._v("Change Password")])]),s._v(" "),t("button",{staticClass:"danger",on:{click:s.deleteSelf}},[t("span",[s._v("Delete Account")])]),s._v(" "),t("button",{staticClass:"primary",on:{click:s.logout}},[t("span",[s._v("Logout")])])],1)])};a._withStripped=!0;var n=t(271),o=t(79),i=t(517),r=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("transition",{attrs:{name:"fade"}},[s.active?t("div",{staticClass:"change-pass-modal modal is-active",attrs:{role:"dialog","aria-modal":"modal"}},[t("div",{staticClass:"modal-background",on:{click:function(e){return s.cancel()}}}),s._v(" "),t("div",{staticClass:"modal-card"},[t("header",[t("span",[s._v("Change Password")])]),s._v(" "),t("section",[t("div",{staticClass:"field"},[t("input",{directives:[{name:"model",rawName:"v-model",value:s.password,expression:"password"}],ref:"pass",staticClass:"warning",attrs:{type:"password",required:"",placeholder:"old password"},domProps:{value:s.password},on:{input:function(e){e.target.composing||(s.password=e.target.value)}}}),s._v(" "),t("span",{staticClass:"error"},[s._v(s._s(""===s.password?"required":""))])]),s._v(" "),t("div",{staticClass:"field"},[t("input",{directives:[{name:"model",rawName:"v-model",value:s.newpass,expression:"newpass"}],staticClass:"warning",attrs:{type:"password",required:"",placeholder:"new password"},domProps:{value:s.newpass},on:{keydown:function(e){return!e.type.indexOf("key")&&s._k(e.keyCode,"enter",13,e.key,"Enter")?null:s.confirm()},input:function(e){e.target.composing||(s.newpass=e.target.value)}}}),s._v(" "),t("span",{staticClass:"error"},[s._v(s._s(null!=s.newpass?""===s.newpass?"required":s.newpass.length<4?"at least 4 characters":"":""))])])]),s._v(" "),t("footer",[t("button",{on:{click:s.cancel}},[s._v("cancel")]),s._v(" "),t("button",{staticClass:"warning",attrs:{disabled:!s.password||!s.newpass},on:{click:s.confirm}},[s._v("confirm")])])])]):s._e()])};r._withStripped=!0;const c={name:"tiny-change-pass-modal",data:()=>({active:!1,password:void 0,newpass:void 0}),mounted(){this.active=!0,this.$nextTick((()=>{var s;return null===(s=this.$refs.pass)||void 0===s?void 0:s.focus()})),window.addEventListener("keyup",this.onKey)},destroyed(){window.removeEventListener("keyup",this.onKey)},methods:{confirm(){this.active&&this.password&&this.newpass&&!(this.newpass.length<4)&&(this.$emit("confirm",{password:this.password,newpass:this.newpass}),this.close())},cancel(){this.active&&(this.$emit("cancel"),this.close())},close(){this.active&&(this.active=!1,setTimeout((()=>{var s;this.$destroy(),void 0!==(s=this.$el).remove?s.remove():void 0!==s.parentNode&&null!==s.parentNode&&s.parentNode.removeChild(s)}),150))},onKey(s){this.active&&"Escape"===s.key&&this.cancel()}}};var l=t(900),d=(0,l.Z)(c,r,[],!1,null,null,null);d.options.__file="src/web/components/change-pass-modal.vue";const p=d.exports,u={name:"tiny-home",data(){var s;return{working:!1,username:(null===(s=n.Z.user)||void 0===s?void 0:s.username)||"???"}},mounted(){this.refresh()},methods:{async refresh(){this.working||(this.working=!0,this.working=!1)},async changePass(){const s=await(0,i.MO)(p);s&&await o.Z.auth.changePass(s.password,s.newpass).catch((()=>{}))},async logout(){await o.Z.auth.logout(),this.$router.push("/login")},async deleteSelf(){const s=await(0,i.h7)({title:"Delete Account",type:"danger",message:"Are you sure you want to delete your account? This cannot be undone.",prompt:{type:"password",placeholder:"password",required:!0}});s&&(await o.Z.deleteSelf(s).catch((()=>{})),this.$router.push("/login"))}}};var v=(0,l.Z)(u,a,[],!1,null,null,null);v.options.__file="src/web/pages/home.vue";const h=v.exports}}]);